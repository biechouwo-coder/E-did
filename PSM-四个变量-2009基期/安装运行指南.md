# Python环境配置和运行指南

## 问题说明

当前系统的Python环境可能需要配置或安装。请按照以下步骤操作。

## 方案一：安装Python（推荐）

### 1. 下载并安装Python

访问 Python官网下载安装包：
- https://www.python.org/downloads/
- 推荐下载 Python 3.9 或 3.10 版本

安装时**务必勾选**：
- ✓ "Add Python to PATH"（将Python添加到环境变量）

### 2. 验证安装

打开**命令提示符**（cmd）或**PowerShell**，运行：

```bash
python --version
```

如果显示Python版本号（如 `Python 3.9.7`），说明安装成功。

### 3. 安装所需的库

在命令提示符中运行：

```bash
pip install pandas numpy scikit-learn matplotlib seaborn scipy openpyxl
```

或者逐个安装：

```bash
pip install pandas
pip install numpy
pip install scikit-learn
pip install matplotlib
pip install seaborn
pip install scipy
pip install openpyxl
```

### 4. 测试环境

```bash
cd c:\Users\HP\Desktop\E-did\PSM-四个变量-2009基期
python test_python.py
```

### 5. 运行PSM分析

```bash
python psm_analysis_4vars.py
```

或直接双击运行 `run_psm_4vars.bat`

---

## 方案二：使用Anaconda（科学计算推荐）

### 1. 下载并安装Anaconda

访问：https://www.anaconda.com/download/
下载Windows版本的Anaconda安装包并安装。

### 2. 打开Anaconda Prompt

在开始菜单中找到"Anaconda Prompt"并打开。

### 3. 安装所需的库

```bash
conda install pandas numpy scikit-learn matplotlib seaborn scipy
pip install openpyxl
```

### 4. 运行分析

```bash
cd c:\Users\HP\Desktop\E-did\PSM-四个变量-2009基期
python psm_analysis_4vars.py
```

---

## 方案三：使用Jupyter Notebook（推荐用于交互式分析）

### 1. 安装Jupyter

如果已安装Python：

```bash
pip install jupyter
```

### 2. 启动Jupyter

```bash
cd c:\Users\HP\Desktop\E-did\PSM-四个变量-2009基期
jupyter notebook
```

### 3. 在浏览器中创建新的notebook

复制 `psm_analysis_4vars.py` 的内容到notebook中运行。

---

## 常见问题

### 问题1：运行python命令时弹出Microsoft Store

**原因**：Windows检测到python命令但没有找到Python安装。

**解决方案**：
1. 从Python官网安装完整的Python（记得勾选"Add to PATH"）
2. 或者直接运行已安装的Python（如果有其他Python环境）

### 问题2：pip不是内部或外部命令

**解决方案**：
1. 确保安装Python时勾选了"Add Python to PATH"
2. 或使用完整路径：`python -m pip install 包名`

### 问题3：ModuleNotFoundError: No module named 'xxx'

**解决方案**：
```bash
pip install xxx
```

例如：
```bash
pip install pandas
```

### 问题4：无法读取Excel文件

**解决方案**：安装openpyxl库
```bash
pip install openpyxl
```

---

## 快速检查清单

在运行PSM分析前，请确认：

- [ ] Python已安装（运行 `python --version` 验证）
- [ ] pip可用（运行 `pip --version` 验证）
- [ ] 所需库已安装（运行 `python test_python.py` 验证）
- [ ] 数据文件存在：`../总数据集2007-2019_含碳排放强度.xlsx`

---

## 运行成功的标志

当一切正常时，运行 `psm_analysis_4vars.py` 应该看到：

```
================================================================================
PSM倾向得分匹配分析（四个匹配变量）
================================================================================

[步骤1] 读取数据...
原始数据形状: (xxxx, xx)
年份范围: 2007 - 2019

[步骤2] 提取2009年基期数据...
2009年样本数: xxx
...
```

最后会在当前文件夹生成多个结果文件。

---

## 需要帮助？

如果按照上述步骤仍然无法运行，请检查：

1. Windows系统版本和位数（32位或64位）
2. Python版本（建议3.8-3.10）
3. 是否有管理员权限（安装某些库可能需要）

或者尝试在Anaconda环境下运行，这是最简单的方案。
